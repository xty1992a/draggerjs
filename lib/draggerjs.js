!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("Dragger",[],e):"object"==typeof exports?exports.Dragger=e():t.Dragger=e()}(window,function(){return function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="/",n(n.s=0)}([function(t,e,n){"use strict";n.r(e);var r=document.createElement("div").style,i=function(){var t={webkit:"webkitTransform",Moz:"MozTransform",O:"OTransform",ms:"msTransform",standard:"transform"};for(var e in t)if(void 0!==r[t[e]])return e;return!1}();var o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}();function a(t){if(Array.isArray(t)){for(var e=0,n=Array(t.length);e<t.length;e++)n[e]=t[e];return n}return Array.from(t)}function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var c=function(){function t(e){s(this,t),Object.assign(this,e)}return o(t,[{key:"centerX",get:function(){return this.left+this.width/2}},{key:"centerY",get:function(){return this.top+this.height/2}}]),t}(),d={isMobile:!1,getPosOfParent:function(t){var e=t.parentNode.getBoundingClientRect(),n=t.getBoundingClientRect();return new c({width:n.width,height:n.height,top:n.top-e.top,left:n.left-e.left,right:n.right-e.left,bottom:n.bottom-e.top,index:t.dataset.hasOwnProperty("index")?+t.dataset.index:-1})},isCover:function(t,e){return!(arguments.length>2&&void 0!==arguments[2])||arguments[2]?Math.max(t.centerY,e.centerY)-Math.min(t.centerY,e.centerY)<(t.height+e.height)/2:Math.max(t.centerX,e.centerX)-Math.min(t.centerX,e.centerX)<(t.width+e.width)/2},css:function(t,e){Object.keys(e).forEach(function(n){var r=e[n];["transform","transition"].includes(n)&&(n=function(t){return!1!==i&&("standard"===i?"transitionEnd"===t?"transitionend":t:i+t.charAt(0).toUpperCase()+t.substr(1))}(n)),t.style[n]=r})},getParentByClassName:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.body;if(t.classList.contains(e))return t;for(var r=t.parentNode,i=null;r;)r.classList.contains(e)?(i=r,r=null):(r=r.parentNode)===n&&(r=null);return i}};!function(){try{document.createEvent("TouchEvent"),d.isMobile=!0}catch(t){d.isMobile=!1}}();var u={dir:"y",change:!0},l=function(){function t(e,n){s(this,t),this.children=[],this.rectList=[],this.threshold=[],this.targetIndex=0,this.task={},this.point=null,this.drag=null,this.dragIndex=-1,this.moveDir="",this.moveRect=null,this.$el=e,Object.assign(this,u,n),this.$init()}return o(t,[{key:"$init",value:function(){this.freshThreshold(),this.listen()}},{key:"changeItem",value:function(t){var e=t.source,n=t.target;if(e!==n){var r=this.$el,i=[].concat(a(r.children)),o=i.splice(e,1),s=i.splice(0,n);i=[].concat(a(s),a(o),a(i));var c=document.createDocumentFragment();i.forEach(function(t){return c.appendChild(t)}),r.innerHTML="",r.appendChild(c),this.freshThreshold()}}},{key:"freshThreshold",value:function(){this.children=Array.from(this.$el.children),this.children.forEach(function(t,e){t.classList.add("drag-item"),t.dataset.index=e});var t=this.rectList=this.children.map(function(t){return d.getPosOfParent(t)});"x"===this.dir&&(this.threshold=t.map(function(t){return t.centerX})),"y"===this.dir&&(this.threshold=t.map(function(t){return t.centerY}))}},{key:"listen",value:function(){var t=this,e={down:d.isMobile?"touchstart":"mousedown",move:d.isMobile?"touchmove":"mousemove",up:d.isMobile?"touchend":"mouseup"};this.$el.addEventListener(e.down,function(e){var n=d.getParentByClassName(e.target,"drag-item");if(n){t.moved=!1,t.downTime=(new Date).getTime(),t.dragStart=!0;var r=e.clientX,i=e.clientY;t.drag=n,d.css(n,{zIndex:10});var o=n.getBoundingClientRect();t.targetIndex=t.dragIndex=+n.dataset.index,t.children.forEach(function(e,n){n===t.dragIndex?e.classList.add("drag-handler"):e.classList.contains("drag-item")&&e.classList.add("drag-move")}),t.moveRect=d.getPosOfParent(t.drag),t.point={posX:r-o.left,posY:i-o.top,startX:r,startY:i,moveX:r,moveY:i}}}),this.$el.addEventListener(e.move,function(e){if(e.preventDefault(),t.dragStart){t.moved=!0,d.isMobile&&(e=e.touches[0]);var n=e,r=n.clientX,i=n.clientY,o=t.point,a=o.startX,s=i-o.startY,c=r-a;return t.translate(),"y"===t.dir&&(t.moveRect.top=t.rectList[t.dragIndex].top+s,t.moveDir=t.point.moveY>i?"up":"down",t.moveLine=t.threshold[t.dragIndex]+s,d.css(t.drag,{transform:"translate3d("+c+"px,"+s+"px,0)"})),"x"===t.dir&&(t.moveRect.left=t.rectList[t.dragIndex].top+c,t.moveDir=t.point.moveX>r?"up":"down",t.moveLine=t.threshold[t.dragIndex]+c,d.css(t.drag,{transform:"translate3d(0,"+s+"px,0)"})),t.point.moveX=r,t.point.moveY=i,t.translate(),!1}}),document.addEventListener(e.up,function(e){if(e.preventDefault(),t.dragStart){t.dragStart=!1,t.point=null,t.drag&&(t.drag.classList.remove("drag-handler"),d.css(t.drag,{transform:"translate3d(0,0,0)",zIndex:0,opacity:1})),t.children.forEach(function(t){d.css(t,{transform:"translate3d(0,0,0)"})});var n=(new Date).getTime()-t.downTime;if(t.moved&&n>100){var r={source:t.dragIndex,target:t.targetIndex};t.fire("drag-over",r),t.change&&t.changeItem(r);var i=t.targetIndex;setTimeout(function(){var e=t.rectList[i];t.fire("swap-over",{index:t.targetIndex,rect:e})},500)}else t.fire("click-over",{index:t.dragIndex,rect:t.currentRect});return t.children.forEach(function(t){t.classList.contains("drag-item")&&t.classList.remove("drag-move")}),t.drag=null,t.moveRect=null,t.dragIndex=-1,!1}})}},{key:"translate",value:function(){var t=this,e=[];this.targetIndex=0;var n=null,r=[],i=function(t,e){return!0},o="up";"y"===this.dir&&(this.currentRect.top>this.moveRect.top?(e=[].concat(a(this.rectList)).map(function(t,e){return e}).splice(0,this.dragIndex).map(function(e){return t.rectList[e]}),i=function(t,e){return t.bottom>e.centerY},o="up",n=this.children[this.dragIndex+1]):this.currentRect.top<this.moveRect.top&&(e=[].concat(a(this.rectList)).map(function(t,e){return e}).splice(this.dragIndex+1).map(function(e){return t.rectList[e]}),i=function(t,e){return t.top<e.top+e.height/2},o="down",n=this.children[this.dragIndex-1]),e.forEach(function(e){if(i(e,t.moveRect)){r.push(e.index);var n="up"===o?t.moveRect.height:-t.moveRect.height;d.css(t.children[e.index],{transform:"translate3d(0, "+n+"px, 0)"})}else d.css(t.children[e.index],{transform:"translate3d(0,0,0)"})}),this.targetIndex="up"===o?r.length?r[0]:this.dragIndex:r.length?r[r.length-1]:this.dragIndex,n&&d.css(n,{transform:"translate3d(0,0,0)"}))}},{key:"on",value:function(t,e){this.task[t]=e}},{key:"fire",value:function(t,e){this.task[t]&&this.task[t](e)}},{key:"down",value:function(t){}},{key:"move",value:function(t){}},{key:"up",value:function(t){}},{key:"currentRect",get:function(){return this.rectList[this.dragIndex]||null}}]),t}();e.default=l}]).default});